

<!DOCTYPE html>
<html lang="ko-kr">
  <head>
    
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KZXLS88');</script>
    

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="Hugo 0.55.3" />
    <link rel="shortcut icon" href="/images/favicon.ico">
    <link href="http://integerous.github.io/index.xml" rel="alternate" type="application/rss+xml" title="ryan-han.com âŒ ğŸ¡’ integer.blog â­•ï¸" />
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:700i" rel="stylesheet">
    
    <script src="https://apis.google.com/js/platform.js" async defer>{lang: 'ja'}</script>
    
    <link rel="stylesheet" href="https://yandex.st/highlightjs/8.0/styles/default.min.css">
    <script src="https://yandex.st/highlightjs/8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    
    <link rel="stylesheet" type="text/css" href="/css/single.css">
    <title>AWS VPC ì´ì •ë¦¬ | ryan-han.com âŒ ğŸ¡’ integer.blog â­•ï¸</title>
  </head>
  <body>
    
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KZXLS88"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  
    <div id="wrap">
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-126908369-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

      <header class="site-header">
        <div class="site-header-left">
          <a class="site-header-title" href="http://integerous.github.io/">ryan-han.com âŒ ğŸ¡’ integer.blog â­•ï¸</a>
        </div>
      </header>
      <div class="container">
        <div id="main">




<div class="article">
  <header>
    <div class="article-header">
      <h1>AWS VPC ì´ì •ë¦¬</h1>
      <div class="article-meta">
        <span class="posttime">2018/10/07</span>


        
<div class="tags">
  <ul>
    
    <li>
        <a href="/tags/aws">AWS</a>
    </li>
    
  </ul>
</div>


      </div>
    </div>
    
  </header>
  <div class="content">
    <h3> ë¸”ë¡œê·¸ ì˜®ê²¼ìŠµë‹ˆë‹¤! ğŸ¡’ <a href="https://www.integer.blog/?ref=ryan-han.com">integer.blog</a></h3>
    

<blockquote>
<p><a href="https://www.udemy.com/aws-certified-solutions-architect-associate/">AWS Certified Solutions Architect - Associate 2018</a> ê°•ì˜ë¥¼ ë“£ê³  ë‚´ìš© ì •ë¦¬</p>
</blockquote>

<p><img src="https://github.com/Integerous/TIL/blob/master/AWS/img/VPCdiagram.png?raw=true" alt="VPC Diagram" /></p>

<h2 id="1-what-is-a-vpc">1. What is a VPC ?</h2>

<p>VPCëŠ” í´ë¼ìš°ë“œ ë‚´ì˜ <strong>ê°€ìƒ ë°ì´í„° ì„¼í„°</strong>.</p>

<h2 id="2-what-can-you-do-with-a-vpc">2. What can you do with a VPC ?</h2>

<ul>
<li>ë‚´ê°€ ì„ íƒí•œ ì„œë¸Œë„·ì— ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.</li>
<li>ê°ê°ì˜ ì„œë¸Œë„·ì— ì»¤ìŠ¤í…€ IPì£¼ì†Œ ë²”ìœ„ë¥¼ í• ë‹¹í•  ìˆ˜ ìˆë‹¤.</li>
<li>ì„œë¸Œë„· ê°„ì˜ Route tablesë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

<ul>
<li>Route Tables : ì–´ë–¤ ì„œë¸Œë„·ì´ ë‹¤ë¥¸ ì„œë¸Œë„·ë“¤ê³¼ speak í•  ìˆ˜ ìˆëŠ”ì§€ ì •í•´ë†“ì€ ê²ƒ.</li>
</ul></li>
<li>ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ë¥¼ ìƒì„±í•˜ê³  ìš°ë¦¬ì˜ VPCì— ë¶™ì¼ ìˆ˜ ìˆë‹¤.</li>
<li>AWS ìì›ë“¤ì„ ë”ìš± ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.

<ul>
<li>ì„œë¸Œë„· ì‚¬ìš©, íŠ¹ì • IPì£¼ì†Œ ë§‰ê¸°, ë„¤íŠ¸ì›Œí¬ ACLS ë“±ì„ í†µí•´ì„œ.</li>
</ul></li>
<li>ì¸ìŠ¤í„´ìŠ¤ ë³´ì•ˆê·¸ë£¹</li>
<li>ì„œë¸Œë„· ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ ê´€ë¦¬ ë¦¬ìŠ¤íŠ¸(ACLS)</li>
</ul>

<h2 id="3-default-vpc-vs-custom-vpc">3. Default VPC vs Custom VPC</h2>

<h3 id="default-vpc">Default VPC</h3>

<ul>
<li>ì‚¬ìš©í•˜ê¸° ì‰½ê³ , ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¦‰ì‹œ ë°°í¬í•  ìˆ˜ ìˆê²Œí•œë‹¤.</li>
<li>Default VPCì˜ ëª¨ë“  ì„œë¸Œë„·ë“¤ì€ ì¸í„°ë„·ì— ì—°ê²°í•  ìˆ˜ ìˆë‹¤.</li>
<li>í”„ë¼ì´ë¹— ì„œë¸Œë„·ì´ ì—†ë‹¤.</li>
<li>ê°ê°ì˜ EC2 ì¸ìŠ¤í„´ìŠ¤ëŠ” í¼ë¸”ë¦­ IPì™€ í”„ë¼ì´ë¹—IPë¥¼ ëª¨ë‘ ê°€ì§€ê³  ìˆë‹¤</li>
</ul>

<h3 id="custom-vpc">Custom VPC</h3>

<ul>
<li>í”„ë¼ì´ë¹— ì„œë¸Œë„·ì´ ìˆë‹¤.</li>
<li>ê°ê°ì˜ EC2 ì¸ìŠ¤í„´ìŠ¤ëŠ” í”„ë¼ì´ë¹— IPë§Œ ê°€ì§€ê³  ìˆë‹¤.</li>
</ul>

<h2 id="4-vpc-peering">4. VPC Peering</h2>

<ul>
<li>í”„ë¼ì´ë¹— IPì£¼ì†Œë“¤ì„ ì´ìš©í•´ì„œ VPC ë¼ë¦¬ ë‹¤ì´ë ‰íŠ¸ ë„¤íŠ¸ì›Œí¬ ë£¨íŠ¸ë¡œ ì—°ê²°í•œë‹¤.</li>
<li>ì¸ìŠ¤í„´ìŠ¤ë“¤ì€ ê°™ì€ í”„ë¼ì´ë¹— ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ” ê²ƒì²˜ëŸ¼ ì—¬ê²¨ì§„ë‹¤.</li>
<li>ë‹¤ë¥¸ AWS ê³„ì •ì˜ VPCì™€ë„ ì—°ê²°í•  ìˆ˜ ìˆê³ , ê°™ì€ ê³„ì •ì˜ VPCì™€ë„ ì—°ê²°í•  ìˆ˜ ìˆë‹¤.</li>
<li>VPC Aì™€ B, Aì™€ Cê°€ ì—°ê²°ë˜ì–´ìˆì–´ë„ Bì™€ Cê°€ ì—°ê²°ë˜ì–´ìˆì§€ ì•Šìœ¼ë©´ ì—°ê²°ë˜ì§€ ì•ŠëŠ”ë‹¤. (we don&rsquo;t have transitive peering in VPC)<br />
<img src="https://github.com/Integerous/TIL/blob/master/AWS/img/VPCtransitivePeering.png?raw=true" alt="" /></li>
</ul>

<h2 id="5-summary">5. Summary</h2>

<ul>
<li>VPCëŠ” AWS ë‚´ì˜ ë…¼ë¦¬ì  ë°ì´í„°ì„¼í„°ë¼ ìƒê°í•˜ë©´ ëœë‹¤.</li>
<li>êµ¬ì„±

<ul>
<li>Internet Gateways ë˜ëŠ” Virtual Private Gateways</li>
<li>Route Tables</li>
<li>Network Acess Control Lists</li>
<li>Subnets</li>
<li>Security Groups</li>
</ul></li>
<li>1 Subnet = 1 Availability Zone</li>
<li>Security GroupsëŠ” Stateful í•˜ë‹¤.(ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœë¥¼ ì¶”ì í•  ìˆ˜ ìˆë‹¤.)</li>
<li>Network Access Control ListsëŠ” Stateless í•˜ë‹¤.</li>
<li>NO TRANSITIVE PEERING</li>
</ul>

<h1 id="vpc-ì‹¤ìŠµ-1">VPC ì‹¤ìŠµ 1</h1>

<h3 id="1-vpc-ë§Œë“¤ê¸°">1. <strong>VPC ë§Œë“¤ê¸°</strong></h3>

<ul>
<li>Your VPCs ë¡œ ì´ë™</li>
<li>Create VPC</li>
<li>Name tag ë° IPv4 CIDR block ì„¤ì • (ê°€ì¥ í° ë²”ìœ„ëŠ” 10.0.0.0/16)</li>
<li>IPv6 CIDR block = Amazon provided IPv6 CIDR block ìœ¼ë¡œ ì„¤ì •í•´ì•¼ ë‚˜ì¤‘ì— ë” ë§ì€ ì˜µì…˜ì´ ìƒê¸´ë‹¤.</li>
<li>Tenancy ì„ íƒ

<ul>
<li>Default: ë‹¤ë¥¸ ê³ ê°ê³¼ í•˜ë“œì›¨ì–´ë¥¼ ê³µìœ í•œë‹¤.(Multi tenant environment)</li>
<li>Dedicate: ë…ë¦½ëœ í•˜ë“œì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ë” ë¹„ì‹¸ë‹¤.</li>
</ul></li>
</ul>

<h3 id="2-í˜„ì¬ê¹Œì§€-ìƒíƒœ">2. <strong>í˜„ì¬ê¹Œì§€ ìƒíƒœ</strong></h3>

<p><img src="https://github.com/Integerous/TIL/blob/master/AWS/img/VPC%20with%20Public%20&amp;%20Private%20Subnet1.png?raw=true" alt="" /></p>

<h3 id="3-subnet-ë§Œë“¤ê¸°">3. <strong>Subnet ë§Œë“¤ê¸°</strong></h3>

<ul>
<li>Subnetsë¡œ ì´ë™</li>
<li>Create Subnets</li>
<li>VPC ì„ íƒ</li>
<li>Name tag ì„¤ì •(ê°•ì‚¬ëŠ” CIDR block rangeì™€ AZì„ ë‚˜íƒ€ë‚´ê¸°ìœ„í•´ <code>10.0.1.0 - us-east-1a</code> ë¼ê³  ì„¤ì •í•œë‹¤.)</li>
<li>Availability Zone ì„¤ì • (us-east-1a)</li>
<li>IPv4 CIDR block ì„¤ì • (10.0.1.0/24)</li>
<li>IPv6 CIDR block ì„ íƒ (ê°•ì‚¬ëŠ” ì•ˆí•¨)</li>
<li>Yes, Create í´ë¦­</li>
</ul>

<h3 id="4-ê°-ì„œë¸Œë„·-cidr-ë¸”ë¡ì—ì„œ-ì²«-4ê°œì˜-ip-ì£¼ì†Œì™€-ë§ˆì§€ë§‰-ip-ì£¼ì†ŒëŠ”-ì‚¬ìš©ìê°€-ì‚¬ìš©í• -ìˆ˜-ì—†ìœ¼ë¯€ë¡œ-ì¸ìŠ¤í„´ìŠ¤ì—-í• ë‹¹í• -ìˆ˜-ì—†ìŠµë‹ˆë‹¤-ì˜ˆë¥¼-ë“¤ì–´-10-0-0-0-24-cidr-ë¸”ë¡ì˜-ì„œë¸Œë„·ì—ì„œëŠ”-ë‹¤ìŒ-5ê°œ-ip-ì£¼ì†Œê°€-ì˜ˆì•½ë˜ì–´-ìˆìŠµë‹ˆë‹¤">4. ê° ì„œë¸Œë„· CIDR ë¸”ë¡ì—ì„œ ì²« 4ê°œì˜ IP ì£¼ì†Œì™€ ë§ˆì§€ë§‰ IP ì£¼ì†ŒëŠ” ì‚¬ìš©ìê°€ ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ì¸ìŠ¤í„´ìŠ¤ì— í• ë‹¹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 10.0.0.0/24 CIDR ë¸”ë¡ì˜ ì„œë¸Œë„·ì—ì„œëŠ” ë‹¤ìŒ 5ê°œ IP ì£¼ì†Œê°€ ì˜ˆì•½ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</h3>

<ul>
<li>10.0.0.0: ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œ.</li>
<li>10.0.0.1: AWSì—ì„œ VPC ë¼ìš°í„°ìš©ìœ¼ë¡œ ì˜ˆì•½í•œ ì£¼ì†Œ.</li>
<li>10.0.0.2: AWSì—ì„œ ì˜ˆì•½í•œ ì£¼ì†Œ. DNS ì„œë²„ì˜ IP ì£¼ì†ŒëŠ” í•­ìƒ VPC ë„¤íŠ¸ì›Œí¬ ë²”ìœ„ë¥¼ ê¸°ì´ˆë¡œ 2ë¥¼ ë”í•œ ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì—ì„œëŠ” ê° ì„œë¸Œë„· ë²”ìœ„ë¥¼ ê¸°ì´ˆë¡œ 2ë¥¼ ë”í•œ ê²ƒë„ ì˜ˆì•½í•©ë‹ˆë‹¤. CIDR ë¸”ë¡ì´ ì—¬ëŸ¬ ê°œì¸ VPCì˜ ê²½ìš°, DNS ì„œë²„ì˜ IP ì£¼ì†Œê°€ ê¸°ë³¸ CIDRì— ìœ„ì¹˜í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ Amazon DNS ì„œë²„ ë‹¨ì›ì„ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤.</li>
<li>10.0.0.3: AWSì—ì„œ ì•ìœ¼ë¡œ ì‚¬ìš©í•˜ë ¤ê³  ì˜ˆì•½í•œ ì£¼ì†Œ.</li>
<li>10.0.0.255: ë„¤íŠ¸ì›Œí¬ ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì£¼ì†Œ. VPCì—ì„œëŠ” ë¸Œë¡œë“œìºìŠ¤íŠ¸ë¥¼ ì§€ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì´ ì£¼ì†Œë¥¼ ì˜ˆì•½í•©ë‹ˆë‹¤.</li>
</ul>

<h3 id="5-ë‘ë²ˆì§¸-subnet-ë§Œë“¤ê¸°">5. <strong>ë‘ë²ˆì§¸ Subnet ë§Œë“¤ê¸°</strong></h3>

<ul>
<li>IPv4 CIDR block ì„¤ì • (10.0.2.0/24)</li>
<li>AZ ì„¤ì • (us-east-1b)</li>
</ul>

<h3 id="6-í˜„ì¬ê¹Œì§€-ìƒíƒœ">6. <strong>í˜„ì¬ê¹Œì§€ ìƒíƒœ</strong></h3>

<p><img src="https://github.com/Integerous/TIL/blob/master/AWS/img/VPC%20with%20Public%20&amp;%20Private%20Subnet2.png?raw=true" alt="" /></p>

<h3 id="7-internet-gateway-ë§Œë“¤ê¸°">7. <strong>Internet Gateway ë§Œë“¤ê¸°</strong></h3>

<ul>
<li>Create Internet Gateway</li>
<li>Name tag ì„¤ì • (ê°•ì˜ì—ì„œëŠ” MyIGW) ë° Create</li>
<li>Attach to VPC</li>
<li>VPC ì„ íƒ í›„ Yes, Attach</li>
<li><em>í•˜ë‚˜ì˜ Internet GatewayëŠ” í•˜ë‚˜ì˜ VPC ì—ë§Œ ë¶™ì¼ ìˆ˜ ìˆë‹¤.</em></li>
</ul>

<h3 id="8-route-table-ë§Œë“¤ê¸°">8. <strong>Route Table ë§Œë“¤ê¸°</strong></h3>

<ul>
<li>ìƒˆë¡œìš´ ì„œë¸Œë„·ì„ ë§Œë“¤ë©´ defaultë¡œ main route tableì— ì—°ê²°ëœë‹¤. í•˜ì§€ë§Œ ë§¤ë²ˆ ì„œë¸Œë„·ì„ provisioning í•  ë•Œë§ˆë‹¤ main route tableì´ ì¸í„°ë„· Accessableí•˜ê¸° ë•Œë¬¸ì— ìƒˆë¡œìš´ route tableì„ ë§Œë“ ë‹¤.</li>
<li>Create Route Table</li>
<li>Name tag (ê°•ì˜ì—ì„œëŠ” MyInternetRouteOut) ë° VPC ì„¤ì •</li>
<li>Yes, Create</li>
</ul>

<h3 id="9-route-tableì˜-ì¸í„°ë„·-ì—°ê²°-ì„¤ì •í•˜ê¸°">9. <strong>Route Tableì˜ ì¸í„°ë„· ì—°ê²° ì„¤ì •í•˜ê¸°</strong></h3>

<ul>
<li>ìƒˆë¡œ ìƒì„±í•œ Route Table ì„ íƒ</li>
<li>ë°‘ì˜ Routes ì„ íƒí•˜ê³  Edit í´ë¦­</li>
<li>Add another route (0.0.0.0/0 , target = ì¢€ì „ì— ìƒì„±í•œ Interent Gateway)</li>
<li>Save</li>
<li>Add another route (::/0 , target = ìœ„ì™€ ë™ì¼) ë¡œ IPv6ë„ ì„¤ì •í•´ì¤€ë‹¤.</li>
<li>ì´ì œ ì´ routeì— ì—°ê²°ë˜ëŠ” ëª¨ë“  ì„œë¸Œë„·ì€ Public ì„œë¸Œë„·ì´ ëœë‹¤.</li>
</ul>

<h3 id="10-subnetì„-route-tableê³¼-ì—°ê²°í•˜ê¸°">10. <strong>Subnetì„ Route Tableê³¼ ì—°ê²°í•˜ê¸°</strong></h3>

<ul>
<li>Route Tables -&gt; ë°‘ì— Subnet Associations í´ë¦­</li>
<li>Edit</li>
<li>Public Subnetìœ¼ë¡œ ì‚¬ìš©í•  ì„œë¸Œë„·(10.0.1.0)ì„ ì„ íƒí•˜ê³  Save. (ë‚˜ë¨¸ì§€ í•œ ì„œë¸Œë„·ì€ Privateì´ ëœë‹¤.)</li>
<li>Subnetsë¡œ ê°€ì„œ ì˜¤ë¥¸ìª½ ëë¶€ë¶„ì— Auto-assign Public IPì„ í™•ì¸í•˜ë©´ ìƒˆë¡œ ì¶”ê°€í•œ ì„œë¸Œë„·ë“¤ì€ Noë¡œ ë˜ì–´ìˆë‹¤.</li>
<li>Public Subnetìœ¼ë¡œ ì‚¬ìš©í•  ì„œë¸Œë„·ì„ ì„ íƒí•˜ê³ </li>
<li>Subnet Actions -&gt; Modify auto-assign IP settings -&gt; Enable auto-assign public IPv4 address ì²´í¬</li>
<li>Save</li>
</ul>

<h3 id="11-public-ì„œë¸Œë„·ì„-ìœ„í•œ-ec2-ìƒì„±">11. <strong>Public ì„œë¸Œë„·ì„ ìœ„í•œ EC2 ìƒì„±</strong></h3>

<ul>
<li>EC2ë¡œ ì´ë™</li>
<li>Launch Instance í´ë¦­</li>
<li>Amazon Linux AMI í´ë¦­</li>
<li>Networkë¥¼ Default VPCì—ì„œ Custom VPCë¡œ ë³€ê²½</li>
<li>Subnet ì„ íƒ (10.0.1.0)</li>
<li>next next</li>
<li>Add tag ( Name / WebServer01)</li>
<li>next</li>
<li>Security group ìƒì„± (ê°•ì˜ì—ì„œëŠ” Web-DMZ)

<ul>
<li>SSH / 22 / 0.0.0.0/0</li>
<li>HTTP / 80 / 0.0.0.0/0, ::/0</li>
</ul></li>
<li>Keypair ì„ íƒ í›„ ì‹œì‘</li>
</ul>

<h3 id="12-private-ì„œë¸Œë„·ì„-ìœ„í•œ-ec2-ìƒì„±">12. <strong>Private ì„œë¸Œë„·ì„ ìœ„í•œ EC2 ìƒì„±</strong></h3>

<ul>
<li>Subnet ì„ íƒ (10.0.2.0)</li>
<li>Add tag ( Name / MyPrivateServer )</li>
<li>Security ê·¸ë£¹ì€ defaultë¡œ</li>
<li>KeypairëŠ” ìœ„ì—êº¼ë‘ ê°™ì€ ê²ƒ</li>
</ul>

<h3 id="13-sshë¡œ-ì ‘ì†">13. <strong>sshë¡œ ì ‘ì†</strong></h3>

<h3 id="14-í˜„ì¬ê¹Œì§€-ìƒíƒœ">14. <strong>í˜„ì¬ê¹Œì§€ ìƒíƒœ</strong></h3>

<p><img src="https://github.com/Integerous/TIL/blob/master/AWS/img/VPC%20with%20Public%20&amp;%20Private%20Subnet3.png?raw=true" alt="" /></p>

<h3 id="15-ì´í›„ì—-í•´ì•¼í• -ê²ƒ">15. <strong>ì´í›„ì— í•´ì•¼í•  ê²ƒ</strong></h3>

<ul>
<li>ë‘ ê°œì˜ ë³´ì•ˆê·¸ë£¹ì€ ê°ê° Public ê³¼ Defaultê³ ,</li>
<li>ë‘ ê°œì˜ ì„œë¸Œë„·ì€ ê°ê° Publicê³¼ Private ì´ë‹¤.</li>
<li>ê·¸ë˜ì„œ ë‘ ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ëŠ” ì„œë¡œ ë‹¤ë¥¸ ë³´ì•ˆê·¸ë£¹ê³¼ AZ ë•Œë¬¸ì— ì„œë¡œ ì—°ê²°í•  ìˆ˜ ì—†ëŠ” ìƒíƒœì´ë‹¤.</li>
<li>ê·¸ëŸ¬ë¯€ë¡œ ì´í›„ì—ëŠ” ì—°ê²°í•  ìˆ˜ ìˆë„ë¡.</li>
</ul>

<h1 id="vpc-ì‹¤ìŠµ-2">VPC ì‹¤ìŠµ 2</h1>

<blockquote>
<p>ì‹¤ìŠµ 1ì— ì´ì–´ Public ì„œë¸Œë„·ì„ í†µí•´ Private ì„œë¸Œë„·ì— ì ‘ì†í•˜ë„ë¡ í•˜ëŠ” ê²ƒì´ í•µì‹¬</p>
</blockquote>

<h3 id="1-ì¸ìŠ¤í„´ìŠ¤ëª…-ë°-ë³´ì•ˆê·¸ë£¹-ìˆ˜ì •">1. ì¸ìŠ¤í„´ìŠ¤ëª… ë° ë³´ì•ˆê·¸ë£¹ ìˆ˜ì •</h3>

<ul>
<li>MyPrivateServer -&gt; MyMySQL</li>
<li>Security group ìƒì„±

<ul>
<li>ê·¸ë£¹ì´ë¦„,descripting ì„¤ì • (ê°•ì˜ì—ì„œëŠ” My-RDS-SG)</li>
<li>VPC ì„ íƒ (acloudguruVPC)</li>
<li>add rule

<ul>
<li>SSH / 22 / 10.0.1.0/24</li>
<li>MYSQL/Aurora / 3306 / 10.0.1.0/24</li>
<li>HTTP / 80 / 10.0.1.0/24</li>
<li>HTTPS / 443 / 10.0.1.0/24</li>
<li>All ICMP-IPv4 / 0 - 65535 / 10.0.1.0/24</li>
</ul></li>
</ul></li>
<li>ì¸ìŠ¤í„´ìŠ¤ë¡œ ê°€ì„œ -&gt; MyMySQL ì„ íƒ -&gt; action -&gt; change security group ì„ íƒ -&gt; My-RDS-SGë¡œ ë³€ê²½</li>
</ul>

<h3 id="2-sshë¡œ-public-ì„œë²„ì—ì„œ-private-ì„œë²„ë¡œ-ì ‘ì†í•´ë³´ê¸°-ì‹¤ë¬´ì—ì„œëŠ”-ì ˆëŒ€-í•˜ì§€-ë§-ê²ƒ">2. sshë¡œ Public ì„œë²„ì—ì„œ Private ì„œë²„ë¡œ ì ‘ì†í•´ë³´ê¸° (ì‹¤ë¬´ì—ì„œëŠ” ì ˆëŒ€ í•˜ì§€ ë§ ê²ƒ)</h3>

<ul>
<li>ping 10.0.2.143</li>
<li>nano mypvk.pem -&gt; í‚¤ ë‚´ìš© ë³µë¶™</li>
<li>chmod 400 mypvk.pem</li>
<li>ssh ec2-user@10.0.2.143 -i mypvk.pem
<br /></li>
</ul>

<h1 id="network-address-translation-nat-nat-instances-nat-gateways">Network Address Translation(NAT) / NAT Instances &amp; NAT Gateways</h1>

<h3 id="1-nat-instance-ì„¤ì •í•˜ê¸°">1. NAT Instance ì„¤ì •í•˜ê¸°</h3>

<ul>
<li>EC2ë¡œ ì´ë™</li>
<li>ì¸ìŠ¤í„´ìŠ¤ ì‹œì‘í•˜ê¸°</li>
<li>Community AMIs ì„ íƒ</li>
<li>nat ê²€ìƒ‰</li>
<li>amzn-ami-vpc-nat-hvm~.gp2 ì„ íƒ</li>
<li>VPC ì™€ Subnet ì„ íƒ</li>
<li>Tag ì„¤ì • Name / NAT-INSTANCE</li>
<li>ë³´ì•ˆê·¸ë£¹ web-DMZ ì„ íƒ</li>
<li>ì‹œì‘</li>
<li>ë³´ì•ˆê·¸ë£¹ web-DMZì— Https / 443 / 0.0.0.0,::/0 ì¶”ê°€</li>

<li><p>NAT-INSTANCE ì„ íƒ í›„, Actions - Networking - Change Source/Dest. Check ì„ íƒ</p>

<ul>
<li>ê°ê°ì˜ EC2 ì¸ìŠ¤í„´ìŠ¤ëŠ” ë””í´íŠ¸ë¡œ source/destinationì„ ì²´í¬í•œë‹¤. ì´ê²ƒì€ ì¸ìŠ¤í„´ìŠ¤ê°€ ì£¼ê³  ë°›ëŠ” ëª¨ë“  íŠ¸ë˜í”½ì˜ source ë˜ëŠ” destinationì´ ë˜ì–´ì•¼í•œë‹¤ëŠ” ëœ»ì´ë‹¤. í•˜ì§€ë§Œ NAT ì¸ìŠ¤í„´ìŠ¤ëŠ” ìŠ¤ìŠ¤ë¡œê°€ source/destinationì´ ì•„ë‹ˆë”ë¼ë„ ë°˜ë“œì‹œ íŠ¸ë˜í”½ì„ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ê·¸ëŸ¬ë¯€ë¡œ NAT ì¸ìŠ¤í„´ìŠ¤ì˜ source/destination checksë¥¼ ë°˜ë“œì‹œ disable it í•´ì•¼í•œë‹¤.
<br /></li>
</ul></li>

<li><p>VPC - Route Tables ë¡œ ì´ë™</p></li>

<li><p>Default Route í…Œì´ë¸”ì„ ì„ íƒí•˜ê³  ì—¬ê¸°ì—ì„œ NAT ì¸ìŠ¤í„´ìŠ¤ì— ì˜í•´ Route out ë˜ë„ë¡ í•˜ê¸° ìœ„í•´ ë°‘ì— Routes í´ë¦­í•´ì„œ Add another route í´ë¦­</p></li>

<li><p>Destiantionì— 0.0.0.0/0 ë„£ê³  Targetì—ëŠ” MyIGWê°€ ì•„ë‹Œ NAT ì¸ìŠ¤í„´ìŠ¤ ì„ íƒ. ì´ë¡œì¨ NAT ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë°”ê¹¥ì„¸ìƒìœ¼ë¡œ ë‚˜ê°€ëŠ” Route out ì„¤ì •ëœ ê²ƒ.</p></li>
</ul>

<h3 id="2-nat-ì¸ìŠ¤í„´ìŠ¤ì˜-í•œê³„">2. NAT ì¸ìŠ¤í„´ìŠ¤ì˜ í•œê³„</h3>

<ul>
<li>NAT ì¸ìŠ¤í„´ìŠ¤ë¡œ êµ¬ì„±í•˜ëŠ”ê²ƒì€ ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ì— ë‹¨ì¼ AZì´ê¸° ë•Œë¬¸ì— ë³‘ëª©í˜„ìƒì— ì·¨ì•½í•˜ê³ , ë¬¸ì œë°œìƒì‹œ Private Subnet ì•ˆì˜ ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ì¸í„°ë„· ì—‘ì„¸ìŠ¤ë¥¼ ìƒê²Œ ëœë‹¤.</li>
<li>Auto scaling groupì— ì¶”ê°€í•˜ê±°ë‚˜ multiple AZê³¼ multiple Route out to internetì„ ê°€ì§ˆ ìˆ˜ ìˆì§€ë§Œ, ì ì  ë³µì¡í•´ì§ˆ ë¿ì´ë‹¤.</li>
<li>ë‹¤í–‰íˆ ì•„ë§ˆì¡´ì´ NAT Gatewayë¥¼ ì¶œì‹œí–ˆê³ , ì´ë¥¼ í†µí•´ ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ì™€ ë‹¨ì¼ AZì— ì˜ì¡´í•˜ëŠ” ê²ƒì—ì„œ ë²—ì–´ë‚  ìˆ˜ ìˆë‹¤.</li>
</ul>

<h3 id="3-nat-gateway-ì„¤ì •í•˜ê¸°">3. NAT Gateway ì„¤ì •í•˜ê¸°</h3>

<ul>
<li>VPCë¡œ ì´ë™</li>
<li>NAT GatewayëŠ” IPv4ë¡œ ë™ì‘í•˜ê³ , Egress Only Internet GatewayëŠ” IPv6ë¡œ ë™ì‘í•œë‹¤.</li>
<li>NAT Gateway ì„ íƒ ë° Create NAT Gateway í´ë¦­</li>
<li>Subnetì€ ì»¤ìŠ¤í…€ VPCì˜ í¼ë¸”ë¦­ ì„œë¸Œë„· ì„ íƒ</li>
<li>Create New EIP í´ë¦­</li>
<li>Create a NAT Gateway í´ë¦­ (ìƒì„±ë˜ëŠ”ë° 15ë¶„ì •ë„ ì†Œìš”)</li>
<li>NAT Gatewaysë¡œ ê°€ì„œ ë§Œë“  NAT Gatewayì˜ Statusê°€ availableì´ ë˜ë©´ Route Tablesë¡œ ì´ë™</li>
<li>Default Route Table ì„ íƒ ë° ë°‘ì˜ Routes í´ë¦­</li>
<li>Add another route (Destination: 0.0.0.0/0  Target: NAT Gateway) ë° save.</li>
<li>EC2 ì¸ìŠ¤í„´ìŠ¤ë¡œ ì´ë™</li>
</ul>

<h3 id="4-nat-gatewayì™€-nat-instance-ë¹„êµ">4. NAT Gatewayì™€ NAT Instance ë¹„êµ</h3>

<ul>
<li><strong>Availability</strong>

<ul>
<li>NAT Gateway : ë…ë¦½ì ì¸ ì•„í‚¤í…ì³ë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•´ ê°ê°ì˜ AZì— NAT Gatewayë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</li>
<li>NAT Instance : ì¸ìŠ¤í„´ìŠ¤ë“¤ ê°„ì˜ failover(ì‹œìŠ¤í…œ ëŒ€ì²´ ì‘ë™)ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•´ script ì‚¬ìš©</li>
</ul></li>
<li><strong>Bandwidth</strong>

<ul>
<li>NAT Gateway : 10Gbps ê¹Œì§€ ì§€ì›</li>
<li>NAT Instance : ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ì˜ ëŒ€ì—­í­ì— ë”°ë¼ ë‹¤ë¦„</li>
</ul></li>
<li><strong>Maintenance</strong>

<ul>
<li>NAT Gateway : AWSì— ì˜í•´ ê´€ë¦¬ëœë‹¤.</li>
<li>NAT Instance : ì§ì ‘ ê´€ë¦¬í•´ì•¼í•œë‹¤. (ex ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜ ì¸ìŠ¤í„´ìŠ¤ì— OS patch)<br /></li>
</ul></li>
<li><strong>Performance</strong>

<ul>
<li>NAT Gateway : ì†Œí”„íŠ¸ì›¨ì–´ê°€ NAT íŠ¸ë˜í”½ì„ í•¸ë“¤ë§í•˜ê¸° ìœ„í•´ ìµœì í™”ë˜ì–´ìˆë‹¤.</li>
<li>NAT Instance : A generic Amazon Linux AMI that&rsquo;s configured to perform NAT</li>
</ul></li>
<li><strong>Cost</strong>

<ul>
<li>NAT Gateway : ì‚¬ìš©í•œ NAT ê²Œì´íŠ¸ì›¨ì´ì˜ ìˆ˜, ì‚¬ìš©ì‹œê°„, NAT ê²Œì´íŠ¸ì›¨ì´ë¥¼ í†µí•´ ë³´ë‚¸ ë°ì´í„°ì˜ í¬ê¸°ì— ë”°ë¼ ìš”ê¸ˆì´ ë¶€ê³¼ëœë‹¤.</li>
<li>NAT Instance : ì‚¬ìš©í•œ NAT ì¸ìŠ¤í„´ìŠ¤ì˜ ìˆ˜, ì‚¬ìš©ì‹œê°„, ì¸ìŠ¤í„´ìŠ¤ì˜ íƒ€ì…ê³¼ ì‚¬ì´ì¦ˆì— ë”°ë¼ ìš”ê¸ˆì´ ë¶€ê³¼ëœë‹¤.</li>
</ul></li>
<li><strong>Type and Size</strong>

<ul>
<li>NAT Gateway : Uniform offering - íƒ€ì…ê³¼ ì‚¬ì´ì¦ˆë¥¼ ê²°ì •í•  í•„ìš”ì—†ë‹¤.</li>
<li>NAT Instance : ì˜ˆìƒë˜ëŠ” ì›Œí¬ë¡œë“œì— ë”°ë¼ ì•Œë§ëŠ” ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ê³¼ ì‚¬ì´ì¦ˆë¥¼ ì„ íƒí•´ì•¼í•œë‹¤.</li>
</ul></li>
<li><strong>Public IP Addresses</strong>

<ul>
<li>NAT Gateway : ìƒì„±ì‹œì— NAT Gatewayì™€ ì—°ê²°ì‹œí‚¬ ìˆ˜ ìˆëŠ” Elastic IP addressë¥¼ ì„ íƒí•œë‹¤.</li>
<li>NAT Instance : Elastic IP address ë˜ëŠ” Public IP addressë¥¼ ì‚¬ìš©í•œë‹¤.</li>
</ul></li>
<li><strong>Private IP Addresses</strong>

<ul>
<li>NAT Gateway : ê²Œì´íŠ¸ì›¨ì´ë¥¼ ìƒì„±í•  ë•Œ ì„œë¸Œë„·ì˜ IPì£¼ì†Œ ë²”ìœ„ì—ì„œ ìë™ìœ¼ë¡œ ì„ íƒëœë‹¤.</li>
<li>NAT Instance : ì¸ìŠ¤í„´ìŠ¤ë¥¼ ëŸ°ì¹­í• ë•Œ ì„œë¸Œë„·ì˜ IPì£¼ì†Œ ë²”ìœ„ì—ì„œ íŠ¹ì • private IPì£¼ì†Œë¥¼ í• ë‹¹í•œë‹¤.</li>
</ul></li>
<li><strong>Security Groups</strong>

<ul>
<li>NAT Gateway : NAT Gatewayì™€ ì—°ê²°í•  ìˆ˜ ì—†ë‹¤. ëŒ€ì‹  ë³´ì•ˆê·¸ë£¹ì„ NAT ê²Œì´íŠ¸ì›¨ì´ ë’¤ì˜ ë¦¬ì†ŒìŠ¤ì™€ ì—°ê²°í•˜ì—¬ ì¸ë°”ìš´ë“œ/ì•„ì›ƒë°”ìš´ë“œ íŠ¸ë˜í”½ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤.</li>
<li>NAT Instance : NAT Instanceì™€ ê·¸ ë’¤ì˜ ë¦¬ì†ŒìŠ¤ì™€ ì—°ê²°í•˜ì—¬ ì¸ë°”ìš´ë“œ/ì•„ì›ƒë°”ìš´ë“œ íŠ¸ë˜í”½ì„ ì œì–´í•œë‹¤.</li>
</ul></li>
<li><strong>Network ACLs</strong>

<ul>
<li>NAT Gateway : ë„¤íŠ¸ì›Œí¬ ACLì„ ì‚¬ìš©í•˜ì—¬ NAT ê²Œì´íŠ¸ì›¨ì´ê°€ ìœ„ì¹˜í•˜ê³  ìˆëŠ” ì„œë¸Œë„·ì—ì„œ ë³´ë‚´ê³  ë°›ëŠ” íŠ¸ë˜í”½ì„ ì œì–´í•œë‹¤.</li>
<li>NAT Instance : ë„¤íŠ¸ì›Œí¬ ACLì„ ì‚¬ìš©í•˜ì—¬ NAT ì¸ìŠ¤í„´ìŠ¤ê°€ ìœ„ì¹˜í•˜ê³  ìˆëŠ” ì„œë¸Œë„·ì—ì„œ ë³´ë‚´ê³  ë°›ëŠ” íŠ¸ë˜í”½ì„ ì œì–´í•œë‹¤.</li>
</ul></li>
<li><strong>Flow Logs</strong>

<ul>
<li>NAT Gateway : íŠ¸ë˜í”½ì„ ìº¡ì³í•˜ê¸° ìœ„í•´ flow logsë¥¼ ì‚¬ìš©í•œë‹¤.</li>
<li>NAT Instance : íŠ¸ë˜í”½ì„ ìº¡ì³í•˜ê¸° ìœ„í•´ flow logsë¥¼ ì‚¬ìš©í•œë‹¤.</li>
</ul></li>
<li><strong>Port Forwarding</strong>

<ul>
<li>NAT Gateway : ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
<li>NAT Instance : í¬íŠ¸í¬ì›Œë”©ì„ ìœ„í•´ ìˆ˜ë™ìœ¼ë¡œ ì„¤ì •ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•´ì•¼í•œë‹¤.</li>
</ul></li>
<li><strong>Bastion Servers</strong>

<ul>
<li>NAT Gateway : ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
<li>NAT Instance : bastion ì„œë²„ë¡œì„œ ì‚¬ìš©í•œë‹¤.</li>
</ul></li>
<li><strong>Traffic Metrics</strong>

<ul>
<li>NAT Gateway : NAT ê²Œì´íŠ¸ì›¨ì´ì˜ CloudWatch ì§€í‘œë¥¼ í™•ì¸.</li>
<li>NAT Instance : ì¸ìŠ¤í„´ìŠ¤ì˜ CloudWatch ì§€í‘œ í™•ì¸</li>
</ul></li>
<li><strong>Timeout behavior</strong>

<ul>
<li>NAT Gateway : ì—°ê²° ì œí•œì‹œê°„ì´ ì´ˆê³¼í•˜ë©´ NAT ê²Œì´íŠ¸ì›¨ì´ëŠ” ì—°ê²°ì„ ê³„ì†í•˜ë ¤í•˜ëŠ” NAT ê²Œì´íŠ¸ì›¨ì´ ë’¤ì˜ ë¦¬ì†ŒìŠ¤ë¡œ RST íŒ¨í‚·ì„ ë°˜í™˜í•œë‹¤.(FIN íŒ¨í‚· ì•ˆë³´ëƒ„)</li>
<li>NAT Instance : ì—°ê²° ì œí•œì‹œê°„ì´ ì´ˆê³¼í•˜ë©´ NAT ì¸ìŠ¤í„´ìŠ¤ëŠ” NAT ì¸ìŠ¤í„´ìŠ¤ ë’¤ì˜ ë¦¬ì†ŒìŠ¤ë¡œ FIN íŒ¨í‚·ì„ ì „ì†¡í•˜ì—¬ ì—°ê²°ì„ ë‹«ëŠ”ë‹¤.</li>
</ul></li>
<li><strong>IP fragmentation</strong>

<ul>
<li>NAT Gateway : UDP í”„ë¡œí† ì½œì—ì„œ IP ì¡°ê°í™”ëœ íŒ¨í‚·ì˜ ì „ë‹¬ì„ ì§€ì›í•œë‹¤. TCP ë° ICMP í”„ë¡œí† ì½œì— ëŒ€í•´ì„œëŠ” ì¡°ê°í™”ë¥¼ ì§€ì›í•˜ì§€ ì•Šê³ , ì´ëŸ¬í•œ í”„ë¡œí† ì½œì˜ ì¡°ê°í™”ëœ íŒ¨í‚·ì€ ì‚­ì œëœë‹¤.</li>
<li>NAT Instance : UDP, TCP ë° ICMP í”„ë¡œí† ì½œì— ëŒ€í•´ IP ì¡°ê°í™”ëœ íŒ¨í‚·ì˜ ì¬ìˆ˜ì§‘ì„ ì§€ì›í•œë‹¤.</li>
</ul></li>
</ul>

<h3 id="5-nat-gateway-êµ¬ì„±-ëª¨ìŠµ">5. NAT Gateway êµ¬ì„± ëª¨ìŠµ</h3>

<p><img src="https://github.com/Integerous/TIL/blob/master/AWS/img/VPC%20with%20Public%20&amp;%20Private%20Subnet4.png?raw=true" alt="" /></p>

<h3 id="6-ì •ë¦¬">6. ì •ë¦¬</h3>

<ul>
<li><strong>NAT Instance</strong>

<ul>
<li>When creating a NAT instance, Disable Source/Destination Check on the Instance</li>
<li>NAT instances must be in a public subnet</li>
<li>There must be a route out of the private subnet to the NAT instance, in order for this to work</li>
<li>The amount of traffic that NAT insatnaces can support depends on the instance size. If you are bottlenecking, increase the instance size</li>
<li>You can create high availability using Autoscaling Groups, multiple subnets in different AZs, and a script to automate failover</li>
<li>Behind a Security Group</li>
</ul></li>
<li><strong>NAT Gateway</strong>

<ul>
<li>Preferred by the enterprise</li>
<li>Scale automatically up to 10Gbps</li>
<li>No need to patch</li>
<li>Not associated with security groups</li>
<li>Automatically assigned a public ip address</li>
<li>Remember to update your route tables</li>
<li>No need to disable Source/Destination Checks</li>
<li>More secure than a NAT instance

<ul>
<li>Do not have SSH access to your NAT Gateway</li>
</ul></li>
</ul></li>
</ul>

<h1 id="network-access-control-lists-vs-security-groups">Network Access Control Lists vs. Security Groups</h1>

<h2 id="1-network-acl-ì„¤ì •">1. Network ACL ì„¤ì •</h2>

<ul>
<li>VPC ì´ë™</li>
<li>Network ACLs ì´ë™</li>
<li>Create Network ACL í´ë¦­

<ul>
<li>Name tag : MyWebNACL , VPC ì„ íƒí•˜ê³  ìƒì„±</li>
</ul></li>
<li>Inbound Rules ìˆ˜ì •

<ul>
<li>Edit í´ë¦­</li>
<li>Rule #ëŠ” 100ë¶€í„° ì‹œì‘, 100ë²ˆì€ IPv4, 101ë²ˆì€ IPv6.</li>
<li>Ruleì€ ë²ˆí˜¸ ìˆœì„œëŒ€ë¡œ ì ìš©ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 100ë²ˆì— ì—´ì–´ë‘ê³  99ë²ˆì— ë‹«ì•„ë‘ë©´ 99ë²ˆì´ ìš°ì„  ì ìš©ëœë‹¤.</li>
<li>100 HTTP(80) 0.0.0.0/0</li>
<li>200 HTTPS(443) 0.0.0.0/0</li>
<li>300 SSH(22) 0.0.0.0/0</li>
</ul></li>
<li>Outbound Rules ìˆ˜ì •

<ul>
<li>100 HTTP(80) 0.0.0.0/0</li>
<li>200 HTTPS(443) 0.0.0.0/0</li>
<li>300 Custom(1024-65535) 0.0.0.0/0</li>
</ul></li>
<li>Subnet Association ì´ë™

<ul>
<li>ì„œë¸Œë„·ê³¼ ì—°ê²°</li>
</ul></li>
</ul>

<h2 id="2-exam-tips-network-acls">2. Exam Tips - Network ACLs</h2>

<ul>
<li>Your VPC automatically comes a default network ACL, and by default it allows all outbound and inbound traffic</li>
<li>You can create custom network ACLs, By default, each custom network ACL denies all inbound and outbound traffic until you add rules</li>
<li>Each subnet in your VPC must be associated with a network ACL. If you don&rsquo;t explicitly associate a subnet with a network ACL, the subnet is automatically associated with the default network ACL</li>
<li>You can associate a network ACL with multiple subnets; however, a subnet can be associated with only one network ACL at a time. When you associate a network ACL with a subnet, the previous association is removed</li>
<li>Network ACLs contain a numbered list of rules that is evaluated in order, starting with the lowest numbered rule</li>
<li>Network ACLs are stateless; responses to allowed inbound traffic are subject to the rules for outbound traffic (and vice versa)</li>
<li>Block IP Addresses using network ACLs not Security Groups</li>
</ul>

<h1 id="load-balancers-custom-vpcs">Load Balancers &amp; Custom VPCs</h1>

<blockquote>
<p>Elastic Load BalancerëŠ” ë“¤ì–´ì˜¤ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ íŠ¸ë˜í”½ì„ EC2 ì¸ìŠ¤í„´ìŠ¤, ì»¨í…Œì´ë„ˆ, IPì£¼ì†Œì™€ ê°™ì€ ì—¬ëŸ¬ ëŒ€ìƒì— ìë™ìœ¼ë¡œ ë¶„ì‚°ì‹œí‚¨ë‹¤.<br />
ë˜í•œ ë‹¨ì¼ AZ ë˜ëŠ” ë‹¤ìˆ˜ì˜ AZì—ì„œ ë‹¤ì–‘í•œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë¶€í•˜ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.</p>
</blockquote>

<h2 id="load-balancer-ì„¤ì •">Load Balancer ì„¤ì •</h2>

<ul>
<li>Application Load Balancer ìƒì„±

<ul>
<li>Name ì„¤ì • (MyALB)</li>
<li>Internet facing</li>
<li>IPv4</li>
<li>HTTP / 80</li>
<li>VPC ì„ íƒ</li>
<li>ìƒì„± ì™„ë£Œ
<br /></li>
</ul></li>
</ul>

<h1 id="vpc-flow-logs">VPC Flow Logs</h1>

<blockquote>
<p>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC<br />
Flow log data is stored using Amazon CloudWatch Logs. After creating a flow log, you can view and retrieve its data in Amazon CloudWatch Logs.</p>
</blockquote>

<ul>
<li>Flow logs can be created at 3 levels

<ul>
<li>VPC</li>
<li>Subnet</li>
<li>Network Interface Level</li>
</ul></li>
</ul>

<h2 id="flow-log-ì„¤ì •">Flow Log ì„¤ì •</h2>

<ul>
<li>VPCë¡œ ì´ë™</li>
<li>VPC ì„ íƒ í›„ Actions -&gt; Create Flow Log</li>
<li>Filter ì„ íƒ</li>
<li>Role ì„¤ì • (ì²˜ìŒì—ëŠ” Set Up Permissionsë¡œ ì„¤ì •)</li>
<li>Destination Log Group ì„¤ì • (ì²˜ìŒì—ëŠ” CloudWatchë¡œ ê°€ì„œ ì„¤ì •)

<ul>
<li>CloudWatch ì´ë™</li>
<li>ì¢Œì¸¡ ë©”ë‰´ì— Logs ì„ íƒ</li>
<li>Create log group í´ë¦­í•˜ê³  ìƒì„±</li>
<li>Flow log ìƒì„± í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
<br /></li>
</ul></li>
</ul>

<h2 id="vpc-flow-logs-exam-tips">VPC Flow Logs Exam Tips</h2>

<ul>
<li>You cannot enable flow logs for VPCs that are peered with your VPC unless the peer VPC is in your account.</li>
<li>You cannot tag a flow log.</li>
<li>After you&rsquo;ve creaeted a flow log, you cannot change its configuration; for example, you can&rsquo;t associate a different IAM role with the flow log.</li>
<li>Not all IP Traffic is monitored

<ul>
<li>Traffic generated by instances when they contact the Amazon DNS server. If you use your own DNS server, then all traffic to that DNS server is logged.</li>
<li>Traffic generated by a Windows instance for Amazon Windows license activation.</li>
<li>Traffic to and from 169.254.169.254 for instance metadata.</li>
<li>DHCP traffic</li>
<li>Traffic to the reserved IP address for the default VPC router
<br /></li>
</ul></li>
</ul>

<h1 id="nat-vs-bastion">NAT vs Bastion</h1>

<p><img src="https://github.com/Integerous/TIL/blob/master/AWS/img/VPC%20with%20Public%20&amp;%20Private%20Subnet5.png?raw=true" alt="" /></p>

<h2 id="bastion-host">Bastion host</h2>

<ul>
<li>Bastion hostëŠ” ì™¸ë¶€ì—ì„œ ì ‘ê·¼ì´ ì°¨ë‹¨ë˜ì–´ìˆëŠ” Private Subnetì— ë°°í¬ëœ ì¸ìŠ¤í„´ìŠ¤ì— SSHë¡œ ì ‘ê·¼í•˜ê¸° ìœ„í•œ ì¼ì¢…ì˜ Proxy ì—­í• ì„ í•˜ëŠ” ì„œë²„.<br /></li>
<li>Bastionì˜ loggingì„ ê´€ë¦¬í•˜ë©´ Private Subnetì— ì ‘ì†í•˜ëŠ” ëª¨ë“  ê¸°ë¡ì„ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.</li>
<li>Bastion hostëŠ” Public Subnetì— ìœ„ì¹˜í•˜ë„ë¡ EC2 instanceë¥¼ ìƒì„±í•œë‹¤.</li>
<li>ì™¸ë¶€ ì‚¬ìš©ìì˜ íŠ¹ì • IPë§Œ í—ˆìš©í•˜ì—¬ Bastion hostì— ì ‘ì† ê°€ëŠ¥í•˜ë„ë¡ ë„¤íŠ¸ì›Œí¬ ACLê³¼ Security Groupì„ ì„¤ì •í•œë‹¤.
<br /></li>
</ul>

<h2 id="ssh-tunneling">SSH Tunneling</h2>

<blockquote>
<p>SSH Tunnelingì„ ì´ìš©í•´ì„œ ì™¸ë¶€ì—ì„œ Private Instanceì— ì ‘ì†í•˜ëŠ” ë°©ë²•</p>
</blockquote>

<ol>
<li>Local PCì—ì„œ Bastion hostì— SSH í• ë•Œ, -L ì˜µì…˜ì„ ì´ìš©í•˜ì—¬ ì ‘ì†í•œë‹¤.<br />
<code>ssh -i key.pem -L 22:(ì ‘ì†íƒ€ê²Ÿ ì¸ìŠ¤í„´ìŠ¤ Private IP):22 ec2-user@(Bastion host Public IP)</code>

<ul>
<li>SSHë¥¼ ì´ìš©í•´ Bastion hostì— ì ‘ì†í•  ë•Œ Local í„°ë„ë§ìœ¼ë¡œ ì ‘ì†í•˜ëŠ” ëª…ë ¹ì–´</li>
<li>-L ì˜µì…˜ì¸ <code>22:(ì ‘ì†íƒ€ê²Ÿ ì¸ìŠ¤í„´ìŠ¤ Private IP):22</code> ì˜ ì˜ë¯¸ëŠ” <code>ë¡œì»¬ í¬íŠ¸ 22ë²ˆìœ¼ë¡œ ì ‘ì†íƒ€ê²Ÿ ì¸ìŠ¤í„´ìŠ¤ì˜ 22ë²ˆ í¬íŠ¸ë¡œ ì ‘ì†í•˜ê² ë‹¤</code></li>
</ul></li>
<li>í„°ë¯¸ë„ì„ í•˜ë‚˜ ë” ì—´ì–´ì„œ <code>ssh -i key.pem ec2-user@localhost</code>

<ul>
<li>ìœ„ì˜ ëª…ë ¹ì–´ë¡œ ì ‘ì†í•˜ë©´ ìë™ìœ¼ë¡œ íƒ€ê²Ÿ ì¸ìŠ¤í„´ìŠ¤ë¡œ SSH Tunnelingë˜ì–´ ì ‘ì†ëœë‹¤.</li>
</ul></li>
<li>ì´ ë°©ë²•ìœ¼ë¡œ Private Subnetì— ìœ„ì¹˜í•œ ëª¨ë“  ì„œë²„ì— ì ‘ì†ê°€ëŠ¥</li>
</ol>

<h2 id="nat-vs-bastion-exam-tips">NAT vs Bastion Exam Tips</h2>

<ul>
<li>A NAT is used to provide internet traffic to EC2 instances in private subnets</li>
<li>A Bastion is used to securely administer EC2 instances (using SSH or RDP) in private subnets</li>
</ul>

<h1 id="vpc-endpoint">VPC Endpoint</h1>

<p><img src="https://github.com/Integerous/TIL/blob/master/AWS/img/VPC%20with%20Public%20&amp;%20Private%20Subnet7.png?raw=true" alt="" /></p>

<h2 id="í”„ë¼ì´ë¹—-ë„¤íŠ¸ì›Œí¬ë¡œ-endpoint-s3ì—-ì ‘ê·¼í•˜ê¸°">í”„ë¼ì´ë¹— ë„¤íŠ¸ì›Œí¬ë¡œ Endpoint S3ì— ì ‘ê·¼í•˜ê¸°</h2>

<p><img src="https://github.com/Integerous/TIL/blob/master/AWS/img/VPC%20with%20Public%20&amp;%20Private%20Subnet6.png?raw=true" alt="" /></p>

<h1 id="reference">*Reference</h1>

<ul>
<li><a href="https://aws.amazon.com/">https://aws.amazon.com/</a></li>
<li><a href="https://aws.amazon.com/ko/solutions/case-studies/peoplefund/">https://aws.amazon.com/ko/solutions/case-studies/peoplefund/</a></li>
<li><a href="https://www.udemy.com/aws-certified-solutions-architect-associate/learn/v4/t/lecture/2050704?start=0">https://www.udemy.com/aws-certified-solutions-architect-associate/learn/v4/t/lecture/2050704?start=0</a></li>
<li><a href="http://bluese05.tistory.com/48">http://bluese05.tistory.com/48</a></li>
</ul>

<p></br></p>

<hr />

<p><div style="display: flex; justify-content: space-around">
    <div>
        <a href="http://bit.ly/all-in-one-study">
            <img src="/images/memoirs/2020/all-in-one-1.jpg" width="280" style="filter: drop-shadow(0 0.3rem 0.4rem rgba(0, 0, 0, 0.5))" />
        </a>
    </div>
    <div>
        <a href="http://bit.ly/all-in-one-job">
            <img src="/images/memoirs/2020/all-in-one-2.jpg" width="280" style="filter: drop-shadow(0 0.3rem 0.4rem rgba(0, 0, 0, 0.5))" />
        </a><br />
    </div>
    <div>
        <a href="http://bit.ly/all-in-one-united">
            <img src="/images/memoirs/2020/all-in-one-3.jpg" width="280" style="filter: drop-shadow(0 0.3rem 0.4rem rgba(0, 0, 0, 0.5))" />
        </a><br />
    </div></p>

<h2 id="div"></div></h2>

  </div>
  <footer>
    <div class="article-footer">
      

      
      
      
      
      
      <div id="pagenavigation-next-prev">
        
        <div id="pagenavigation-next">
          <span class="pagenav-label">&lt; ì´ì „ ê¸€</span>
          <a href="http://integerous.github.io/post/dev/deployonec2/">AWS EC2 ì„œë²„ì— Java í”„ë¡œì íŠ¸ ë°°í¬/ì¬ë°°í¬</a>
        </div>
        
        
        <div id="pagenavigation-prev">
          <span class="pagenav-label">ë‹¤ìŒ ê¸€ ></span>
          <a href="http://integerous.github.io/post/dev/stringconcat/">Java ë¬¸ìì—´ ì—°ê²°ë°©ë²• ë¹„êµ</a>
        </div>
        
      </div>
      
    </div>

    <script src="https://utteranc.es/client.js"
    repo="integerous/blog-comments"
    issue-term="pathname"
    crossorigin="anonymous"
    async>
    </script>
  </footer>
</div>





</div>

</div>
<footer>
<div id="site-footer-wrap">
  <div id="site-footer">
    <span>Powered by <a href="https://gohugo.io/">Hugo</a>.</span>
    <span>
      
      Copyright (c) 2023, <a href="http://integerous.github.io/">ryan-han.com âŒ ğŸ¡’ integer.blog â­•ï¸</a>
      
    </span>
  </div>
</div>
</footer>
</div>
</body>
</html>
